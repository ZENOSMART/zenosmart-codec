<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="data:image/png;base64,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" />
    <title>Zenosmart Payload Codec</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header {
            color: #008c47;
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e1e4e8;
        }

        h1 {
            font-size: 27px;
            font-weight: 500;
            color: #1a1a1a;
            margin-bottom: 30px;
            padding-bottom: 15px;
    border-bottom: 1px solid #e1e4e8;
        }

        h2 {
            font-size: 22px;
            font-weight: 400;
            color: #1a1a1a;
            margin-top: 40px;
            margin-bottom: 20px;
            padding-top: 40px;
            border-top: 1px solid #e1e4e8;
        }

        h2:first-of-type {
            border-top: none;
            padding-top: 0;
        }

        ul {
            list-style: none;
            margin-bottom: 20px;
        }

        ul li {
            margin-bottom: 15px;
            padding-left: 20px;
            position: relative;
        }

        ul li::before {
            content: "•";
            position: absolute;
            left: 0;
            color: #333;
            font-weight: bold;
        }

        ul li strong {
            font-weight: 600;
        }

        .note {
            display: block;
            margin-top: 5px;
            font-size: 14px;
            color: #666;
        }

        a {
            color: #0066cc;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .links-list {
            margin: 20px 0;
        }

        .links-list li {
            margin-bottom: 10px;
        }

        .download-note {
            margin: 20px 0;
            font-size: 15px;
        }

        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }

        p {
            margin-bottom: 15px;
            line-height: 1.7;
        }

        pre {
            background-color: #f6f8fa;
            border-radius: 6px;
            padding: 16px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.5;
            border: 1px solid #e1e4e8;
        }

        .structure-item {
            margin-bottom: 10px;
        }

        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e1e4e8;
            text-align: right;
            font-size: 12px;
            color: #666;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">zenosmart-codecs</div>


        <h1>Zenosmart Payload Codec</h1>

        <h2>Supported devices</h2>
        <ul>
            <li>
                <strong>cm30xx:</strong> CM3011, CM3013, CM3021, CM3022, CM3030, CM3040, CM3061, CM3080, CM3120, CM3130
                with 1.3.x and 2.3.x firmwares.
                <span class="note">Note: 1.3.x and 2.3.x protocol is identical, major version number signifies used
                    radio chipset.</span>
            </li>
            <li>
                <strong>ul20xx:</strong> UL2002, UL2003, UL2014, UL2020, UL2021, UL2023, UL2024, UL2030, UL2033, UL2034,
                UL2053 with 1.0.x and 1.1.x firmwares.
                <span class="note">Note: does not support legacy_status_packet.</span>
            </li>
            <li>
                <strong>um30xx:</strong> UM3070, UM5081, UM3090, UM3100, UM3110, UM3140 with 4.0.x firmware.
            </li>
            <li>
                <strong>im30xx:</strong> IM3060, IM3100
            </li>
        </ul>

        <h2>Live decoding in browser</h2>
        <ul class="links-list">
            <li><a href="#">a</a></li>
            <li><a href="#">a</a></li>
            <li><a href="#">a</a></li>
            <li><a href="#">a</a></li>
        </ul>

        <p class="download-note">
            Or download respective .html file in <a href="#">generated</a> folder.
        </p>

        <h2>Live encoding in browser</h2>
        <ul class="links-list">
            <li><a href="#">UL20xx 1.1.x live encoder</a></li>
        </ul>

        <h2>Using on TTN (or Chirpstack)</h2>
        <ul>
            <li>open minified .js file for appropriate device from generated folder.</li>
            <li>click on file (like <code>/generated/ul20xx_1_0_x_decoder.min.js</code>)</li>
            <li>click on Raw</li>
            <li>copy everything</li>
            <li>in e.g. TTN Select your LCU Application -> then Payload Formatters -> Uplink -> Formatter type: Custom
                Javascript Formatter and paste the code there.</li>
            <li>repeat it for Downlink aswell</li>
        </ul>

        <h2>Supported platforms</h2>
        <ul>
            <li>Chirpstack (how to use chirpstack decoder:
                https://github.com/nasys/nas-codecs/blob/main/NAS%20Codecs%20ChirpstackInstallation%20Guide.md)</li>
            <li>The Things Network (add as Custom Javascript Formatter to both Uplink and Downlink)</li>
            <li>easily adoptable to anything that uses javascript</li>
            <li>at least useful starting point for porting to other platforms / languages TTN has maximum code limit of
                40960 characters. No one thought that anyone needs that much. but yep, some overengineering and there
                you go. If you see this error just use the minified version. e.g. generated/some_decoder.min.js.</li>
        </ul>

        <h2>Codec Overview</h2>
        <ul>
            <li>Written in ES5 javascript (ES5 required by e.g. chirpstack and TTN).</li>
            <li><code>decodeRaw()</code> output raw JSON objects. On UL20xx each data-point contains <code>value</code>
                key plus optionally <code>raw</code>, <code>unit</code> etc. On CM30xx and UM30xx key of data-point
                contains unit (e.g. accumulated_volume_m3) and sometimes __formatted field.</li>
            <li>Raw output can be easily re-formatted or used programmatically. Default
                <code>convertToFormatted()</code> converts raw to compact format where <code>value</code> and
                <code>unit</code> are concatenated and serves as an example.</li>
            <li>Serves as annex for respective Payload Description documents.</li>
        </ul>

        <h2>Implementation Reference</h2>
        <p>
            To understand how to decode a certain packet, one can study generated/xxxxxx_x_x_x_decoder.js file. Start
            from decodeRaw() at the end of the file and move upwards. The actual source is in src/xxxxxx_decoder.js but
            it has several processing steps applied to it.
        </p>

        <h2>Structure</h2>
        <p>Structure is based on TTN.</p>

        <div class="structure-item">data - the decoded output.</div>
        <div class="structure-item">errors - payload parsing errors, field ommited if empty.</div>
        <div class="structure-item">warnings - alerts from the device. field ommited if empty.</div>

        <pre>{
  "data": {},
  "errors": [],
  "warnings": []
}</pre>

        <h2>Decoding output Example</h2>
        <pre>{
  "data": {
    "packet_type": "status_packet",
    "device_unix_epoch": "2020-01-14T14:49:03.000Z",
    "status": {
      "dell_error_external": "false",
      "dell_connection_error": "false",
      "ldr_on": "false",
      "dlg_on": "false",
      "hardware_error": "false",
      "internal_relay_closed": "false"
      "open_sim_output_on": "false",
    },
    "downlink_rssi": "-75 dBm",
    "downlink_snr": "4 dB",
    "mcu_temperature": "21 °C",
    "analog_interfaces": {
      "voltage_alert_in_24h": "false",
      "lamp_error_alert_in_24h": "false",
      "power_alert_in_24h": "false",
      "power_factor_alert_in_24h": "false"
    },
    "ldr_value": "174",
    "profiles": [
      {
        "profile_id": "5",
        "profile_version": "5",
        "profile_override": "none",
        "dell_address_short": "dell_single_s",
        "dell_address": "holiday,mon,tue,wed,thu,fri,sat,sun",
        "dimming_level": "50 %"
      },
      {
        "profile_id": "3",
        "profile_version": "3",
        "profile_override": "none",
        "dell_address_short": "dell_single_s",
        "days_active": "holiday,mon,tue,wed,thu,fri,sat,sun",
        "dimming_level": "0 %"
      }
    ]
  }
}</pre>

        <h2>Reporting errors</h2>
        <p>Please report issues in Github Issues page.</p>

        <h2>Getting started</h2>
        <p>First test the codec Live - See Live decoding example above.</p>

        <p>For testing on your platform download respective file from generated/ folder and modify/replace the entry
            function to call <code>decodeRaw()</code>. Inside that function the output can also be reformatted however
            is needed.</p>

        <p>Since new features are added occasionally and bugs fixed, the library will be updated. Re-generating codec
            files with custom entry function can be achieved by modifying default entry functions in config/ folder and
            then generating the js files again (see Rebuild below).</p>

        <h2>Installation</h2>
        <p>Only needed if one wants to regenerate the output or run tests etc. Node must be installed. To install
            dependencies: <code>npm install</code></p>

        <h2>Build</h2>
        <pre>npm run build_cm30xx_2_3_x && npm run build_cm30xx_2_3_x.html  npm run build_ul20xx_1_0_x && npm run build_ul20xx_1_0_x.html  npm run build_ul20xx_1_1_x && npm run build_ul20xx_1_1_x_ttn_downlink && npm run build_ul20xx_1_1_x_ttn_uplink  npm run build_ul20xx_1_1_x_encoder && npm run build_ul20xx_1_1_x_encoder.html

npm run build_um30xx_4_0_x && npm run build_um30xx_4_0_x.html

npm run build_im30xx_0_9_x && npm run build_im30xx_0_9_x.html</pre>

        <h2>Running tests:</h2>
        <pre>npm test  If src folder has been modified, run at least first half of the build command (generating html not needed). npm run build_cm30xx_2_3_x && npm run build_um30xx_4_0_x && npm run build_ul20xx_1_0_x && npm run build_ul20xx_1_1_x && npm run build_ul20xx_1_1_x_encoder && npm run build_im30xx_0_9_x && npm test</pre>

        <h2>Coverage overlay in VS Code</h2>
        <p>install VS Code 'Jest' extension Cmd+P Command pallete: Jest: Start All Runners Cmd+P Command pallete: Jest:
            Toggle Coverage</p>

        <h2>Third party software</h2>
        <p>UM30xx decoder uses tiny (TMBUS)[https://dev-lab.github.io/tmbus/] library which is licensed under [Apache
            License][https://dev-lab.github.io/tmbus/LICENSE].</p>

        <div class="footer">
            This site is open source. <a href="#">Improve this page.</a>
        </div>
    </div>
</body>

</html>